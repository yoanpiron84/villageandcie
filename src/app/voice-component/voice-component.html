<div *ngIf="showErrorSidebar" class="error-sidebar">
  <p class="error-sidebar">Service momentanÃ©ment indisponible.</p>
</div>

<!-- Chat icon -->
<div class="chat-icon" (click)="toggleChat()">ğŸ’¬</div>

<!-- Chat popup -->
<div *ngIf="showChat" class="chat-popup">
  <!-- Header -->
  <div class="chat-header">
    Chat IA
    <button class="close-btn" (click)="toggleChat()">âœ–</button>
  </div>

  <!-- Messages -->
  <div class="chat-messages">
    <div *ngFor="let msg of chatMessages" class="chat-message" [class.user]="msg.user === 'user'" [class.ai]="msg.user === 'ai'">
      <!-- IcÃ´ne IA / utilisateur -->
      <img *ngIf="msg.user==='ai'" src="images/ia_icon.png" class="chat-avatar" alt="IA">
      <img *ngIf="msg.user==='user'" src="images/user_icon.png" class="chat-avatar" alt="Vous">
      <div class="chat-bubble">{{ msg.text }}</div>
    </div>
  </div>

  <!-- Input -->
  <div class="chat-input">
    <img
      [src]="isRecording ? 'images/micro_rouge.png' : 'images/micro_bleu.png'"
      alt="Microphone"
      class="micro-icon"
    />
    <input type="text" [(ngModel)]="userMessage" placeholder="Ecrivez votre demande ici" (keydown.enter)="sendMessage()" />
    <button (click)="startRecording()">ğŸ™ï¸ Parler</button>
  </div>
</div>

