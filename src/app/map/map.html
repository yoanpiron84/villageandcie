<div id="map-container" class="map-container"></div>


<div class="search-container">
  <input
    type="text"
    [placeholder]="translations['search_placeholder']"
    [(ngModel)]="searchTerm"
    (input)="onSearchInput($event)"
    (blur)="onSearchBlur()"
  />

  <span class="search-icon">ğŸ”</span>

  <button class="toggle-view-btn" (click)="toggleViewOptions()">ğŸŒ</button>

  @if (showViewOptions){
    <div class="view-options-card">
      <div class="view-option" (click)="setMapView('satellite')">
        <img src="/images/satellite.png" alt="Satellite">
        <span>{{ translations['satellite'] }}</span>
      </div>
      <div class="view-option" (click)="setMapView('osm')">
        <img src="/images/osm.png" alt="OSM">
        <span>{{ translations['osm'] }}</span>
      </div>
    </div>
  }

  <button
    class="toggle-pin-btn"
    [class.active]="isPinModeActive"
    (click)="togglePinMode()"
  >
    ğŸ“
  </button>

  @if (showDropdown){
    <ul class="dropdown">
      @for (result of searchResults; track searchResults){
        <li (click)="selectResult(result)" >
          {{ result.display_name }}
        </li>
      }
    </ul>
  }

</div>

<button
  class="btn-localisation"
  [ngClass]="{'activetoinactive-localisation': isLocalisationActive, 'inactivetoactive-localisation': !isLocalisationActive}"
  (click)="toggleLocalisation()">
  {{ isLocalisationActive ? 'DÃ©sactiver ma localisation' : 'Activer ma localisation' }}
</button>

<button class="toggle-filter-btn" (click)="toggleFilterCard()">
  <i class="fa fa-filter"></i>
</button>

<!-- Card Filtre -->
@if (showFilterCard){
  <div class="filter-card">
    <h4>Filtrer par couche</h4>

    <!-- SÃ©lecteur de couche -->
    <select [(ngModel)]="selectedLayerAction">
      @for (action of activeLayers; track action){
        <option [value]="action">{{layerLabels[action]}}</option>
      }
    </select>

    <h4>Filtrer par rayon</h4>
    <label for="radiusSlider">{{currentRadius}} km</label>
    <input #radiusSlider type="range" id="radiusSlider" min="1" max="10" [(ngModel)]="currentRadius"  [disabled]="!canApplyFilter" [ngClass]="{'disabled-btn': !canApplyFilter}" (change)="applyFilter()">
    <div class="filter-actions">
      @if (waitingMessage){
        <div>{{ waitingMessage }}</div>
      }
    </div>
  </div>
}

